<ui:composition
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

  <!-- Modal para crear un nuevo Tipus Documental -->
  <p:dialog id="tipusDocumentalModalDialogId"
            header="Nou Tipus Documental"
            showEffect="fade"
            widgetVar="tipusDocumentalModalDialog"
            modal="true"
            resizable="true"
            style="max-width:1000px; min-width:1000px;">
	  <div class="views_3">
	  	<div class="content_4">
		  	<h:form>
		  		<h2 class="title_first">#{messages['nouTipusDocumental.titol']}</h2>
		  		<div class="separador_rojo"></div>
				<div class="ui-g form_new">
					<p:panel id="panel">
				        <p:messages id="messages" showSummary="false" showDetail="false" style="display:none;"/>
				        
				        <!-- Código -->
						<div class="ui-g-12 item_1">
						    <label class="ui-g-2">#{messages['nouTipusDocumental.codi']}</label>
						    
							    <!-- Parte TD -->
							    <h:outputText value="TD" style="font-weight:bold; margin-right:5px;" />
							    
							    <!-- AutoComplete de prefijo -->
							     <p:autoComplete id="Prefix"
							                    value="#{tipusDocumentalController.prefix}"
							                    completeMethod="#{tipusDocumentalController.autocompletarPrefix}"
							                    converter="prefixConverter"
							                    forceSelection="true"
							                    scrollHeight="250"
							                    placeholder="XX"
							                    minQueryLength="0"
							                    queryDelay="200"
							                    inputStyle="text-align:center; font-weight:bold; padding-right:50px;"
							                    required="true"
							                    requiredMessage="Has de seleccionar un prefix"
							                    dropdown="true">
							    </p:autoComplete>
							    
							    <!-- Separador -->
							    <h:outputText value="-" 
							                  style="font-weight:bold; margin:0 5px;" />
							    
							    <!-- Secuencial -->
							    <p:inputText id="Secuencial"
							                 value="#{tipusDocumentalController.sequencial}"
							                 placeholder="001"
							                 maxlength="3" 
							                 style="width:60px; text-align:center;">
							        <p:keyFilter regEx="/[0-9]/"/>
							    </p:inputText>
							    
							    <h:outputText 
							    	value=" (Deixeu el seqüencial buit per auto-generar)"
							    	style="margin-left:10px; font-style:italic; color:#666;" />
						</div>

					    <!-- Nombre en catalán -->
					    <div class="ui-g-12 item_1">
					    	<label class="ui-g-2">#{messages['nouTipusDocumental.nomcatala']}</label>
			    			<p:inputText id="Nom"
			    				value="#{tipusDocumentalController.nom}"
			    				class="ui-g-10"
			    				required="true"
			    				requiredMessage="El nom no pot estar buit"
			    				validatorMessage="El nom ha de tenir com a màxim 1000 caràcters">
			    				<f:validateLength minimum="0" maximum="1000" />
			    			</p:inputText>
					    </div>

					    <!-- Nombre en castellano -->
					    <div class="ui-g-12 item_1">
					    	<label class="ui-g-2">#{messages['nouTipusDocumental.nomcastella']}</label>
			    			<p:inputText id="NomCas"
			    				value="#{tipusDocumentalController.nomCas}"
			    				class="ui-g-10"
			    				required="false"
			    				validatorMessage="El nom en castellà ha de tenir com a màxim 1000 caràcters">
			    				<f:validateLength minimum="0" maximum="1000" />
			    			</p:inputText>
					    </div>

					    <!-- Definición en catalán -->
					    <div class="ui-g-12 item_1">
					    	<label class="ui-g-2">#{messages['nouTipusDocumental.definicio']}</label>
			    			<p:inputTextarea id="Definicio"
			    				value="#{tipusDocumentalController.definicio}"
			    				class="ui-g-10"
			    				autoResize="false"
        						style="height: 90px; overflow-y: auto;"
			    				required="true"
			    				requiredMessage="La definició no pot estar buida"
			    				validatorMessage="La definició ha de tenir com a màxim 4000 caràcters">
			    				<f:validateLength minimum="0" maximum="4000" />
			    			</p:inputTextarea>
					    </div>

					    <!-- Definición en castellano -->
					    <div class="ui-g-12 item_1">
					    	<label class="ui-g-2">#{messages['nouTipusDocumental.definiciocas']}</label>
			    			<p:inputTextarea id="DefinicioCas"
			    				value="#{tipusDocumentalController.definicioCas}"
			    				class="ui-g-10"
			    				autoResize="false"
        						style="height: 90px; overflow-y: auto;"
			    				required="false"
			    				validatorMessage="La definició en castellà ha de tenir com a màxim 4000 caràcters">
			    				<f:validateLength minimum="0" maximum="4000" />
			    			</p:inputTextarea>
					    </div>
					    
					     <!-- Observaciones -->
					    <div class="ui-g-12 item_1">
					    	<label class="ui-g-2">#{messages['nouTipusDocumental.observacions']}</label>
			    			<p:inputTextarea id="Observacions"
			    				value="#{tipusDocumentalController.observacions}"
			    				class="ui-g-10"
			    				autoResize="false"
        						style="height: 90px; overflow-y: auto;"
			    				required="false"
			    				validatorMessage="L'observació ha de tenir com a màxim 4000 caràcters">
			    				<f:validateLength minimum="0" maximum="4000" />
			    			</p:inputTextarea>
					    </div>

	  					<!-- Botón Guardar -->
					    <div class="ui-g-12 button_new" align="justify">
					    	<p:commandButton
					    		widgetVar="tipusDocumentalSaveButton"
					    		onclick="PF('tipusDocumentalSaveButton').disable()"
					    		class="boton_modal button_red"
					    		process="@form"
					    		update="panel :panel1:TipusDocumentals"
					    		value="#{messages['guardar']}"
					    		action="#{tipusDocumentalController.guardar}"
					    		oncomplete="PF('tipusDocumentalSaveButton').enable();
						                    if (args &amp;&amp; !args.validationFailed) {
						                        var hasErrors = document.querySelectorAll('.ui-message-error, .ui-messages-error').length > 0;
						                        if (!hasErrors) {
						                            PF('tipusDocumentalModalDialog').hide();
						                            setTimeout(function() { 
									                    PF('tipusDocumentalTable').clearFilters(); 
									                }, 1500);
						                        } 
						                    }" />
					    </div>
				    </p:panel>
				</div>
			</h:form>
	  	</div>
	  </div>
	</p:dialog>
</ui:composition>
